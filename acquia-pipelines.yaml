version: 1.0.0
events:
  build:
    steps:
      - version_check:
          script:
            - 'rm -f /tmp/version_check_failure'
            - 'chmod 555 $SOURCE_DIR/check-versions.sh'
            - '$SOURCE_DIR/check-versions.sh "php" "php --version" "7.1.29"'
            - '$SOURCE_DIR/check-versions.sh "php7.2" "php7.2 --version" "7.2.18"'
            - '$SOURCE_DIR/check-versions.sh "acquia-yaml" "gem list acquia-yaml" "1.0.4"'
            - '$SOURCE_DIR/check-versions.sh "composer" "composer --no-ansi --version" "1.8.5"'
            - '$SOURCE_DIR/check-versions.sh "ssh" "echo $(ssh -V 2>&1)" "OpenSSH_7.2p2"'
            - '$SOURCE_DIR/check-versions.sh "rsync" "rsync --version" "3.1.1"'
            - '$SOURCE_DIR/check-versions.sh "nodejs" "node --version" "v6.14.4"'
            - '$SOURCE_DIR/check-versions.sh "git" "git --version" "2.17.0"'
            - '$SOURCE_DIR/check-versions.sh "unzip" "echo $(unzip -v | grep UnZip)" "6.00"'
            - '$SOURCE_DIR/check-versions.sh "bzip2" "echo $(bzip2 --version 2>&1 | grep Version)" "1.0.6"'
            - '$SOURCE_DIR/check-versions.sh "gem" "gem --version" "3.0.3"'
            - '$SOURCE_DIR/check-versions.sh "npm" "npm --version" "3.10.10"'
            - '$SOURCE_DIR/check-versions.sh "drush default" "drush --version" "8.2.3"'
            - '$SOURCE_DIR/check-versions.sh "drush6" "drush6 --version" "6.7.0"'
            - '$SOURCE_DIR/check-versions.sh "drush7" "drush7 --version" "7.4.0"'
            - '$SOURCE_DIR/check-versions.sh "drush8" "drush8 --version" "8.2.3"'
            - '$SOURCE_DIR/check-versions.sh "wget" "wget --version" "1.17"'
            - '$SOURCE_DIR/check-versions.sh "mysql" "mysql --version" "5.6.16"'
            - '$SOURCE_DIR/check-versions.sh "memcached" "apt-cache show memcached" "Version: 1.4.25"'
            - '$SOURCE_DIR/check-versions.sh "patch" "patch --version" "2.7.5"'
            - '$SOURCE_DIR/check-versions.sh "nvm" "nvm --version" "0.34.0"'
            - '$SOURCE_DIR/check-versions.sh "google-chrome" "google-chrome --version" "74.0.3729.131"'
            - '$SOURCE_DIR/check-versions.sh "rbenv" "rbenv -v" "1.1.2"'
            - '$SOURCE_DIR/check-versions.sh "rbenv 2.3.x" "rbenv versions" "2.3.8"'
            - '$SOURCE_DIR/check-versions.sh "rbenv 2.4.x" "rbenv versions" "2.4.6"'
            - '$SOURCE_DIR/check-versions.sh "bundler" "bundle --version" "2.0.1"'
            - '$SOURCE_DIR/check-versions.sh "fontconfig" "echo $(fc-list --version 2>&1)" "2.11.94"'
            - '$SOURCE_DIR/check-versions.sh "imagemagick" "echo $(convert 2>&1 | head -n1)" "6.8.9-9"'
            - '$SOURCE_DIR/check-versions.sh "php gd" "php -i" "GD library Version => 2.1.1"'
            - '$SOURCE_DIR/check-versions.sh "php gpm" "php -i" "GMP version => 6.1.0"'
            - '$SOURCE_DIR/check-versions.sh "php mcrypt" "php -i" "mcrypt" -2 "Version => 2.5.8"'
            - '$SOURCE_DIR/check-versions.sh "php mysqli" "php -i" "Client API library version => mysqlnd 5.0.12-dev"'
            - '$SOURCE_DIR/check-versions.sh "php pdo_mysql" "php -i" "PDO Driver for MySQL" -2 "Client API version => mysqlnd 5.0.12-dev"'
            - '$SOURCE_DIR/check-versions.sh "php memcached" "php -i" "memcached" -2 "Version => 3.1.3"'
            - '$SOURCE_DIR/check-versions.sh "php zip" "php -i" "Zip version => 1.13.5"'
            - '$SOURCE_DIR/check-versions.sh "php bz2" "php -i" "BZip2 Version => 1.0.6"'
            - '$SOURCE_DIR/check-versions.sh "php imagick" "php -i" "imagick module version => 3.4.3"'
            - '$SOURCE_DIR/check-versions.sh "php curl" "php -i" "cURL Information => 7.47.0"'
            - '$SOURCE_DIR/check-versions.sh "imagemagick" "convert --version" "6.8.9-9"'
            - '$SOURCE_DIR/check-versions.sh "php pcntl extension" "php -i" "pcntl support => enabled"'
            - '$SOURCE_DIR/check-versions.sh "php bcmath extension" "php -i" "BCMath support => enabled"'
            - '$SOURCE_DIR/check-versions.sh "php xsl extension" "php -i" "XSL => enabled"'
            - '$SOURCE_DIR/check-versions.sh "php7.2 pcntl extension" "php7.2 -i" "pcntl support => enabled"'
            - '$SOURCE_DIR/check-versions.sh "php7.2 bcmath extension" "php7.2 -i" "BCMath support => enabled"'
            - '$SOURCE_DIR/check-versions.sh "php7.2 xsl extension" "php7.2 -i" "XSL => enabled"'
            - 'if [ -f /tmp/version_check_failure ]; then'
            -   'echo "Failures in the version check:"'
            -   'cat /tmp/version_check_failure'
            -   'exit 1'
            - 'fi'
